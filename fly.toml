# fly.toml (root)
app = "serenity"
primary_region = "fra"

[build]
# Dockerfile
dockerfile = "Dockerfile"

[env]
PORT = "8000"
ENVIRONMENT = "production"
DJANGO_SETTINGS_MODULE = "config.settings"

[http_service]
internal_port = 8000
force_https = true
auto_start_machines = true
auto_stop_machines = true
min_machines_running = 1

# Run DB migrations + collectstatic
[deploy]
release_command = "python manage.py migrate && python manage.py collectstatic --noinput"
